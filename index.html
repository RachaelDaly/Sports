<!DOCTYPE html>
<html>
<head>
	<title>Login</title>
	<meta charset="utf-8"/>

	<!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
	<style type="text/css">
		#login{
			padding-top: 40px;
			padding-bottom: 40px;

		}
		#form{
			padding-left: 15px;
			padding-right: 15px;
		}
		body{
			background-color: lightgrey;
		}
	</style>
	<script type="application/javascript">
		const saveToFile = [];

		function loadJSON(username, password){
			console.log("form submitted");
			var data_file = "data.json";
			var http_request = new XMLHttpRequest();
			 try{
               // Opera 8.0+, Firefox, Chrome, Safari
               http_request = new XMLHttpRequest();
            }catch (e){
               // Internet Explorer Browsers
               try{
                  http_request = new ActiveXObject("Msxml2.XMLHTTP");
          
               }catch (e) {
        
                  try{
                     http_request = new ActiveXObject("Microsoft.XMLHTTP");
                  }catch (e){
                     // Something went wrong
                     alert("Your browser broke!");
                     return false;
                  }
          
               }
            }
            console.log("requesting data");
			http_request.onreadystatechange = function(){
				if(http_request.readyState == 4){
					var jsonObj = JSON.parse(http_request.responseText);
					for (var i = 0; i < jsonObj.length; i++){
						if(jsonObj[i].username == username && jsonObj[i].password == password){
							window.location.href = "http://www.se.rit.edu/~rld5989/swen344/sportsRSS/home.html";
							return true;
						}
					}
				}
			}
			http_request.open("GET", data_file, true);
			http_request.send();
		}

		function saveInfo(user, pass){
			var data_file = "data.json";
	        const xhr = new XMLHttpRequest();
	        xhr.open('POST', data_file);
	        xhr.setRequestHeader('Content-Type', 'application/json');
	        xhr.addEventListener('load', function() {
	          if (this.status === 201) { // we've successfully posted
	            namesToDisplay.push({
	            	"username": user,
	            	"password": pass
	            });
	            updateDisplayedNames();
	          }
	        });
	        xhr.send(JSON.stringify({name}));
		}

		function getDataFromFile(){
			const xhr = new XMLHttpRequest();
			xhr.open('GET', 'data.json');
       	 	xhr.addEventListener('load', function() {
          	const response = JSON.parse(this.responseText);
          	console.log("response: " + response);
          	const remoteNames = response.filter((n) => n.length); // make sure we
                                                                // axe empties
          		remoteValues.forEach((n) => saveToFile.push(n));
        	});
        	xhr.send();
		}	
	</script>
</head>
<body>
	<div id="login">
		<h1 class="text-center">Sign In</h1>
		<form id="form">
			<div class="form-group">
				<label for="usernameinput">Username</label>
				<input type="text" class="form-control" id="username" required><br>
			</div>
			<div class="form-group">
				<label for="passwordinput">Password</label>
				<input type="text" class="form-control" id="password" required><br>
			</div>
			<div class="text-center">
				<input type="button" class="btn btn-primary" value="Login" onclick="loadJSON(document.getElementById('username').value, document.getElementById('password').value)">
				<input type="button" class="btn btn-primary" value="Create User" onclick="saveInfo(document.getElementById('username').value, document.getElementById('password').value)">
			</div>
		</form>
	</div>
</body>
</html>
